<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UnliftedFFITypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Text.Internal.ArrayUtils</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.Internal.ArrayUtils.html#memchr"><span class="hs-identifier">memchr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if defined(PURE_HASKELL)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Array</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">elemIndex</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/Foreign.C.Types.html#/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/System.Posix.Types.html#/System.Posix.Types.html"><span class="hs-identifier">System.Posix.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/System.Posix.Types.html#CSsize/System.Posix.Types.html#CSsize"><span class="hs-identifier">CSsize</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/GHC.Exts.html#/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Prim.html#ByteArray%23/GHC.Prim.html#ByteArray%23"><span class="hs-identifier">ByteArray#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/Data.Word.html#/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="annot"><a href="Data.Text.Internal.ArrayUtils.html#memchr"><span class="hs-identifier hs-type">memchr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Prim.html#ByteArray%23/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-cpp">
#if defined(PURE_HASKELL)
</span><span class="hs-identifier">memchr</span><span> </span><span class="hs-identifier">arr#</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tempBa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">A.ByteArray</span><span> </span><span class="hs-identifier">arr#</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">elemIndex</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">A.toList</span><span> </span><span class="hs-identifier">tempBa</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-22"></span><span>        </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span>
</span><span id="line-23"></span><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">i</span><span class="hs-cpp">
#else
</span><span id="memchr"><span class="annot"><span class="annottext">memchr :: ByteArray# -&gt; Int -&gt; Int -&gt; Word8 -&gt; Int
</span><a href="Data.Text.Internal.ArrayUtils.html#memchr"><span class="hs-identifier hs-var hs-var">memchr</span></a></span></span><span> </span><span id="local-6989586621679149362"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679149362"><span class="hs-identifier hs-var">arr#</span></a></span></span><span> </span><span id="local-6989586621679149363"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149363"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621679149364"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149364"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679149365"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679149365"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSsize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.19.1.0-cbb2/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(CSsize -&gt; Int) -&gt; CSsize -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.19.1.0-cbb2/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; CSize -&gt; CSize -&gt; Word8 -&gt; CSsize
</span><a href="Data.Text.Internal.ArrayUtils.html#c_memchr"><span class="hs-identifier hs-var">c_memchr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679149362"><span class="hs-identifier hs-var">arr#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
</span><a href="Data.Text.Internal.ArrayUtils.html#intToCSize"><span class="hs-identifier hs-var">intToCSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149363"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
</span><a href="Data.Text.Internal.ArrayUtils.html#intToCSize"><span class="hs-identifier hs-var">intToCSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149364"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679149365"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><a href="Data.Text.Internal.ArrayUtils.html#intToCSize"><span class="hs-identifier hs-type">intToCSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/Foreign.C.Types.html#CSize/Foreign.C.Types.html#CSize"><span class="hs-identifier hs-type">CSize</span></a></span><span>
</span><span id="line-28"></span><span id="intToCSize"><span class="annot"><span class="annottext">intToCSize :: Int -&gt; CSize
</span><a href="Data.Text.Internal.ArrayUtils.html#intToCSize"><span class="hs-identifier hs-var hs-var">intToCSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.19.1.0-cbb2/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_hs_text_memchr&quot;</span></span><span> </span><span id="c_memchr"><span class="annot"><a href="Data.Text.Internal.ArrayUtils.html#c_memchr"><span class="hs-identifier hs-var">c_memchr</span></a></span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.11.0-8a73/src/GHC.Prim.html#ByteArray%23/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/Foreign.C.Types.html#CSize/Foreign.C.Types.html#CSize"><span class="hs-identifier hs-type">CSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/Foreign.C.Types.html#CSize/Foreign.C.Types.html#CSize"><span class="hs-identifier hs-type">CSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.19.1.0-cbb2/src/System.Posix.Types.html#CSsize/System.Posix.Types.html#CSsize"><span class="hs-identifier hs-type">CSsize</span></a></span><span class="hs-cpp">
#endif
</span></pre></body></html>